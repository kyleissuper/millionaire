<!DOCTYPE html>
<html lang="en">
<body>
<script type="text/javascript">
"use strict";
{
  function shuffle(a) {
    for (let i = a.length; i; i--) {
      let j = Math.floor(Math.random() * i);
      [a[i - 1], a[j]] = [a[j], a[i - 1]];
      return a;
    }
  }
  const possibleQuestions = [
    {
      level: 1,
      question: "In the children's book series, where is Paddington Bear originally from?",
      wrongAnswers: [
        "India",
        "Canada",
        "Iceland"
      ],
      rightAnswer: "Peru"
    },
    {
      level: 1,
      question: "What letter must appear at the beginning of the registration number of all non-military aircraft in the U.S.?",
      wrongAnswers: [
        "A",
        "U",
        "L"
      ],
      rightAnswer: "N"
    },
    {
      level: 2,
      question: "Who delivered the less famous two-hour speech that preceded Abraham Lincoln's two-minute Gettysburg Address?",
      wrongAnswers: [
        "Wendell Phillips",
        "Daniel Webster",
        "Robert G.Ingersoll"
      ],
      rightAnswer: "Edward Everett"
    },
    {
      level: 2,
      question: "'Nephelococcygia' is the practice of doing what?",
      wrongAnswers: [
        "Sleeping with your eyes open",
        "Breaking glass with your voice",
        "Swimming in freezing water"
      ],
      rightAnswer: "Finding shapes in clouds"
    }
  ];
  // Screen manager --> Timer + Questions
  // Score manager
  const levels = 2;
  const qna = {
    init() {
      this.loadQuestions(levels);
    },
    questions: [],
    loadQuestions(levels) {
      // assume possibleQuestions loaded
      function oneForLevel(questions, level) {
        let selectedQuestions = [];
        questions.forEach((q) => {
          if (q["level"] === level) {
            selectedQuestions.push(q);
          }
        });
        let index = Math.floor(
            Math.random() * selectedQuestions.length
            );
        return selectedQuestions[index];
      }
      for( let i = 1; i <= levels; i++ ) {
        let q = oneForLevel(possibleQuestions, i);
        q["rightIndex"] = Math.round(Math.random() * 4);
        q["allAnswers"] = shuffle(q["wrongAnswers"].slice());
        q["allAnswers"].splice(
            q["rightIndex"],
            0,
            q["rightAnswer"]);
        delete q["wrongAnswers"];
        this.questions.push(q);
      }
    },
    getQuestion(level) {
      return this.questions[level-1];
    },
    attempt(level, answer) {
      let q = this.getQuestion(level);
      return {
        result: answer === q["rightIndex"],
        rightAnswer: q["rightAnswer"]
      };
    }
  };
  qna.init();
  console.log(qna.getQuestion(1));
  console.log(qna.attempt(1, 0));
};
</script>
</body>
</html>
